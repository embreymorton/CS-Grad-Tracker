<!DOCTYPE html>
<!-- views/report/progressReport.ejs -->


<html>
  <head>
    <title>Reports</title>
    <%- include("../partials/head.ejs") %>
  </head>

  <body>
    <div class="container-fluid h-100">
      <div class="row h-100">
        <div class="col-lg-2 sidebar text-center">

          <%- include("../partials/admin-sidebar.ejs") %>

        </div>
        <div align ="center" class="col-lg-10 panelbg text-center">

          <h3 class="space">Progress Report</h3>
          <span>
            <p><a href="/report/progressReport/downloadXLSX" class="btn btn-primary download-progress-xlsx-button">Download as XLSX</a></p>
            <p><a href="/report/progressReport/downloadCSV" class="btn btn-primary download-progress-csv-button">Download as CSV</a></p>
          </span>


          <% if(report != undefined && report.length>0) { %>
            <div class = "div1">
            <table id="progress-report-table" align="center" border="1" class="table display-table table-striped table-bordered progress-report-table">
              <thead>
                <tr>
                  <th scope="col" class="col-progress-report-last"><div class="hover-text">Semesters Enrolled <span class="tooltip-text" id = "top">Semesters Enrolled</span></div></th>
                  <th scope="col" class="col-progress-report-last"><div class="hover-text">Last Name<span class="tooltip-text" id = "left">Last Name</span></div></th>
                  <th scope="col" class="col-progress-report-first"><div class="hover-text">First Name<span class="tooltip-text" id = "left">First Name</span></div></th>
                  <th scope="col" class="col-progress-report-advisor"><div class="hover-text">Advisor<span class="tooltip-text" id = "left">Advisor</span></div></th>
                  <th scope="col" class="col-progress-report-notes"><div class="hover-text">Other Advisor<span class="tooltip-text" id = "left">non-faculty</span></div></th>
                  <th scope="col" class="col-progress-report-prp"><div class="hover-text">PRP Passed<span class="tooltip-text" id = "left">PRP Passed</span></div></th>
                  <th scope="col" class="col-progress-report-technical"><div class="hover-text">Technical writing<span class="tooltip-text" id = "left">Technical writing approved CS08</span></div></th>
                  <th scope="col" class="col-progress-report-background"><div class="hover-text">Background Prep wksht<span class="tooltip-text" id = "left">approved?</span></div></th>
                  <th scope="col" class="col-progress-report-research"><div class="hover-text">Research discussion<span class="tooltip-text" id = "left">Research discussion 3 Faculty CS12</span></div></th>
                  <th scope="col" class="col-progress-report-prog"><div class="hover-text">Prog prod Requirement<span class="tooltip-text" id = "left">Prog prod Requirement CS13</span></div></th>
                  <th scope="col" class="col-progress-report-ms-program"><div class="hover-text">M.S. CS03<span class="tooltip-text" id = "left">M.S. Program of study approved CS03</span></div></th>
                  <th scope="col" class="col-progress-report-phd-program"><div class="hover-text">Ph.D. CS06<span class="tooltip-text" id = "left">Ph.D. Program of study approved CS06</span></div></th>
                  <th scope="col" class="col-progress-report-committee"><div class="hover-text">Committee Comp<span class="tooltip-text" id = "left">Committee Comp Approved (COMM form)</span></div></th>
                  <th scope="col" class="col-progress-report-phd"><div class="hover-text">PhD Proposal<span class="tooltip-text" id = "left">PhD Proposal Approved (COMM form)</span></div></th>
                  <th scope="col" class="col-progress-report-oral"><div class="hover-text">Oral Exam<span class="tooltip-text" id = "left">Oral Exam passed (DER form)</span></div></th>
                  <th scope="col" class="col-progress-report-defense"><div class="hover-text">Dis defense<span class="tooltip-text" id = "left">Dis defense passed (DER form)</span></div></th>
                  <th scope="col" class="col-progress-report-dissertation"><div class="hover-text">Dissertation submitted<span class="tooltip-text" id = "left">Dissertation submitted</span></div></th>
                  <th scope="col" class="col-progress-report-notes"><div class="hover-text">Notes<span class="tooltip-text" id = "left">Notes</span></div></th>
                  <th scope="col" class="col-progress-report-academic-review"><div class="hover-text">Academic Review<span class="tooltip-text" id = "left">per Semester (4 is Excellent, 1 is Poor)</span></div></th>
                  <th scope="col" class="col-progress-report-employment-review"><div class="hover-text">Employment Review<span class="tooltip-text" id = "left">per Semester (4 is Very Good, 1 is Poor, 0 is N/A)</span></div></th>
                </tr>
              </thead>
              <tbody>
                <%
                  report.sort(function(x, y) {
                    return y.activeSemesters - x.activeSemesters;
                  })
                %>
                <% for(var i=0; i<report.length; i++) { %>
                  <tr>
                    <td><%= (report[i].activeSemesters == -1 ? "" : report[i].activeSemesters)%></td>
                    <td><%= report[i].lastName%></td>
                    <td><%= report[i].firstName%></td>
                    <td>
                      <% if(report[i].advisor != null){ %>
                      <%= report[i].advisor.lastName%>, <%= report[i].advisor.firstName%>
                      <% } %>
                      </td>
                    <td>
                      <% var otherAdvs = report[i].otherAdvisor == null || report[i].otherAdvisor.trim().length == 0 ? "N/A" : report[i].otherAdvisor.trim() %>
                      <% var otherResearchAdvs = report[i].otherResearchAdvisor == null || report[i].otherResearchAdvisor.trim().length() == 0 ? "N/A" : report[i].otherResearchAdvisor.trim() %>
                      
                      Other Advisor:
                      <%= otherAdvs %>
                      <br>
                      <br>
                      Research Advisor:
                      <% if(report[i].researchAdvisor != null){ %>
                        <%= report[i].researchAdvisor.lastName%>, <%= report[i].researchAdvisor.firstName%>
                      <% } else { %>
                        N/A
                      <% } %>
                      <br>
                      <br>
                      Other Research Advisor:
                      <%= otherResearchAdvs %>
                    </td>
                    <td <% if(report[i].activeSemesters > 8 && (report[i].prpPassed == undefined || report[i].prpPassed == '')) { %> class="red" <% } %>>
                         <%= report[i].prpPassed%>
                         </td>
                    <td><%= report[i].technicalWritingApproved%></td>
                    <td><%= report[i].backgroundApproved%></td>
                    <td><%= report[i].researchPlanningMeeting%></td>
                    <td><%= report[i].programProductRequirement%></td>
                    <td><%= report[i].msProgramOfStudyApproved%></td>
                    <td><%= report[i].phdProgramOfStudyApproved%></td>
                    <td><%= report[i].committeeCompApproved%></td>
                    <td><%= report[i].phdProposalApproved%></td>
                    <td><%= report[i].oralExamPassed%></td>
                    <td><%= report[i].dissertationDefencePassed%></td>
                    <td><%= report[i].dissertationSubmitted%></td>

                    <td>
                      <%if (report[i].notes) { %>
                        <% for(var j=report[i].notes.length - 1; j>=0; j--) { %>
                          <p>
                            <strong>Note #<%= j+1%>:</strong> <%= report[i].notes[j].title%> (<%= report[i].notes[j].date%>)
                            <br>
                            <%= report[i].notes[j].note%>
                          </p>
                        <% } %>
                      <% } %>
                    </td>

                    <td> <!-- academic reviews -->
                      <%if (report[i].semesterProgress) { %>
                        <% for(var j = 0; j < report[i].semesterProgress.length; j++) { %>
                          <p>
                            <strong><%=report[i].semesterProgress[j].semesterString%>:</strong> <%= report[i].semesterProgress[j].academicRating%>
                            <br>
                            <%= report[i].semesterProgress[j].academicComments%>
                          </p>
                        <% } %>
                      <% } %>
                    </td>

                    <td> <!-- employment reviews -->
                      <%if (report[i].semesterProgress) { %>
                        <% for(var j = 0; j < report[i].semesterProgress.length; j++) { %>
                          <p>
                            <strong><%=report[i].semesterProgress[j].semesterString%>:</strong> <%= report[i].semesterProgress[j].rataRating%>
                            <br>
                            <%= report[i].semesterProgress[j].rataComments%>
                          </p>
                        <% } %>
                      <% } %>
                    </td>

                  </tr>
                <% } %>
              </tbody>
            </table>
            </div>
          <% } else { %>
            <div>No students found.</div>
          <% } %>

        </div>
      </div>
    </div>
  </body>
</html>
